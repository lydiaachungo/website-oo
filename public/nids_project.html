<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IDS THREAT HUNTER | v2.0</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    :root {
        --bg: #050505;
        --panel: #111;
        --border: #333;
        --accent: #00f2ff;
        --critical: #ff0055;
        --warning: #ffcc00;
        --safe: #00ff9d;
        --text: #e0e0e0;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'JetBrains Mono', monospace; }
    
    body { background: var(--bg); color: var(--text); padding: 20px; max-width: 1200px; margin: 0 auto; min-height: 100vh; }

    /* HEADER */
    header { 
        display: flex; justify-content: space-between; align-items: center; 
        border-bottom: 2px solid var(--accent); padding-bottom: 15px; margin-bottom: 20px;
    }
    h1 { font-size: 1.5rem; text-transform: uppercase; letter-spacing: 2px; }
    h1 span { color: var(--accent); }
    
    .status-bar { font-size: 0.8rem; display: flex; gap: 15px; }
    .status-item i { margin-right: 5px; color: var(--safe); }

    /* GRID LAYOUT */
    .grid { display: grid; grid-template-columns: 1fr 350px; gap: 20px; }

    /* INPUT AREA */
    .input-panel { background: var(--panel); border: 1px solid var(--border); padding: 15px; border-radius: 4px; }
    .panel-header { font-size: 0.9rem; font-weight: bold; color: var(--accent); margin-bottom: 10px; display: flex; justify-content: space-between; }
    
    textarea {
        width: 100%; height: 200px; background: #000; color: var(--safe); border: 1px solid var(--border);
        padding: 15px; font-size: 0.85rem; resize: none; outline: none; font-family: 'Courier New', monospace;
    }
    
    .controls { margin-top: 15px; display: flex; gap: 10px; }
    button {
        padding: 10px 20px; border: 1px solid var(--accent); background: rgba(0, 242, 255, 0.1); 
        color: var(--accent); font-weight: bold; cursor: pointer; transition: 0.3s;
    }
    button:hover { background: var(--accent); color: #000; }
    button.critical { border-color: var(--critical); color: var(--critical); background: rgba(255, 0, 85, 0.1); }
    button.critical:hover { background: var(--critical); color: #fff; }

    /* RESULTS FEED */
    .feed-panel { display: flex; flex-direction: column; gap: 10px; }
    
    .threat-card {
        background: #0a0a0a; border-left: 4px solid var(--border); padding: 15px; 
        position: relative; animation: slideIn 0.3s ease-out;
    }
    .threat-card.CRITICAL { border-left-color: var(--critical); background: linear-gradient(90deg, rgba(255,0,85,0.05), transparent); }
    .threat-card.HIGH { border-left-color: var(--warning); }
    
    .threat-header { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; font-weight: bold; }
    .mitigation-box { 
        margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.05); 
        font-size: 0.8rem; color: #aaa; border: 1px dashed #444; 
    }
    .mitigation-box strong { color: var(--safe); display: block; margin-bottom: 5px; }

    /* SIDEBAR STATISTICS */
    .stats-panel { background: var(--panel); border: 1px solid var(--border); padding: 20px; height: fit-content; }
    .stat-row { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 5px; }
    .stat-val { font-weight: bold; font-size: 1.2rem; }

    @keyframes slideIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

    .nav-link { margin-top: 20px; display: inline-block; color: #666; text-decoration: none; }
    .nav-link:hover { color: var(--accent); }

</style>
</head>
<body>

<header>
    <h1>SENTINEL <span>// THREAT_HUNTER</span></h1>
    <div class="status-bar">
        <span class="status-item"><i class="fas fa-check-circle"></i> ENGINE: ONLINE</span>
        <span class="status-item"><i class="fas fa-database"></i> SIG_DB: V2.4</span>
    </div>
</header>

<div class="grid">
    <div>
        <div class="input-panel">
            <div class="panel-header">
                <span>TRAFFIC LOG INGESTION</span>
                <span id="typing-indicator" style="display:none; color:var(--safe)">RECEIVING STREAM...</span>
            </div>
            <textarea id="log-input" placeholder="// Paste logs manually or initialize LIVE SIMULATION..."></textarea>
            
            <div class="controls">
                <button onclick="runAnalysis()"><i class="fas fa-search"></i> ANALYZE STATIC</button>
                <button onclick="toggleLiveMode()" id="btn-live"><i class="fas fa-satellite-dish"></i> START LIVE FEED</button>
                <button class="critical" onclick="exportReport()"><i class="fas fa-file-download"></i> EXPORT REPORT</button>
                <button onclick="clearLogs()" style="margin-left:auto; border-color:#555; color:#555;">CLEAR</button>
            </div>
        </div>

        <div style="margin-top:20px;">
            <div class="panel-header">DETECTION FEED & MITIGATION</div>
            <div id="results-feed" class="feed-panel">
                <div style="text-align:center; padding:20px; color:#444; border:1px dashed #333;">NO THREATS DETECTED</div>
            </div>
        </div>
    </div>

    <div class="stats-panel">
        <div class="panel-header">SESSION TELEMETRY</div>
        
        <div class="stat-row">
            <span>PACKETS SCANNED</span>
            <span class="stat-val" id="count-scanned">0</span>
        </div>
        <div class="stat-row">
            <span>THREATS BLOCKED</span>
            <span class="stat-val" style="color:var(--critical)" id="count-threats">0</span>
        </div>
        
        <div style="margin-top:30px;">
            <div class="panel-header">ACTIVE SIGNATURES</div>
            <div style="font-size:0.8rem; color:#666; line-height:1.6;">
                > SQL_INJECTION (SID:1001)<br>
                > XSS_REFLECTED (SID:1002)<br>
                > RCE_SHELLSHOCK (SID:1004)<br>
                > DIR_TRAVERSAL (SID:1005)
            </div>
        </div>
    </div>
</div>

<a href="index.html" class="nav-link">← RETURN TO MAIN TERMINAL</a>

<script>
    // --- 1. SIGNATURE DATABASE WITH MITIGATION ---
    const signatures = [
        {
            regex: /(union\s+select|' OR 1=1)/i,
            name: "SQL INJECTION (SQLi)",
            severity: "CRITICAL",
            mitigation: "Use Prepared Statements (PDO) or Parameterized Queries. Sanitize all user inputs."
        },
        {
            regex: /(<script>|javascript:|onerror=)/i,
            name: "CROSS-SITE SCRIPTING (XSS)",
            severity: "HIGH",
            mitigation: "Implement Content Security Policy (CSP). Encode/Escape all output data."
        },
        {
            regex: /(\.\.\/etc\/passwd|\.\.\\windows)/i,
            name: "DIRECTORY TRAVERSAL",
            severity: "HIGH",
            mitigation: "Validate file paths against a whitelist. Disable root directory access."
        },
        {
            regex: /\(\)\s*\{\s*:\s*;\s*\}\s*;/i,
            name: "SHELLSHOCK (RCE)",
            severity: "CRITICAL",
            mitigation: "Patch Bash to latest version. Filter environment variables in WAF."
        }
    ];

    // --- 2. LOGIC ENGINE ---
    let scannedCount = 0;
    let threatCount = 0;
    let liveInterval = null;
    const inputArea = document.getElementById('log-input');
    const resultsFeed = document.getElementById('results-feed');

    function runAnalysis() {
        const text = inputArea.value;
        if(!text.trim()) return;

        resultsFeed.innerHTML = ""; // Clear feed
        let found = false;

        // Simulate "Scanning" lines
        const lines = text.split('\n');
        scannedCount += lines.length;
        document.getElementById('count-scanned').innerText = scannedCount;

        signatures.forEach(sig => {
            if(sig.regex.test(text)) {
                found = true;
                createAlertCard(sig);
            }
        });

        if(!found) {
            resultsFeed.innerHTML = `<div style="padding:15px; border:1px solid var(--safe); color:var(--safe); background:rgba(0,255,157,0.05)">TRAFFIC ANALYSIS: CLEAN</div>`;
        }
    }

    function createAlertCard(sig) {
        threatCount++;
        document.getElementById('count-threats').innerText = threatCount;

        const card = document.createElement('div');
        card.className = `threat-card ${sig.severity}`;
        card.innerHTML = `
            <div class="threat-header">
                <span style="color:${sig.severity === 'CRITICAL' ? 'var(--critical)' : 'var(--warning)'}">⚠ ${sig.name} DETECTED</span>
                <span>SEVERITY: ${sig.severity}</span>
            </div>
            <div style="font-size:0.8rem; color:#888; margin-bottom:5px;">MATCHED PATTERN: ${sig.regex}</div>
            <div class="mitigation-box">
                <strong><i class="fas fa-tools"></i> RECOMMENDED MITIGATION:</strong>
                ${sig.mitigation}
            </div>
        `;
        resultsFeed.prepend(card);
    }

    // --- 3. LIVE SIMULATION MODE ---
    const sampleLogs = [
        "GET /index.html HTTP/1.1",
        "POST /login.php user=admin&pass=123456",
        "GET /products?id=1' OR 1=1 UNION SELECT user,pass FROM users--", // SQLi
        "GET /images/logo.png",
        "GET /search?q=<script>alert('xss')</script>", // XSS
        "POST /api/v1/update"
    ];

    function toggleLiveMode() {
        const btn = document.getElementById('btn-live');
        const indicator = document.getElementById('typing-indicator');

        if(liveInterval) {
            // STOP
            clearInterval(liveInterval);
            liveInterval = null;
            btn.innerHTML = `<i class="fas fa-satellite-dish"></i> START LIVE FEED`;
            btn.style.background = "";
            indicator.style.display = "none";
        } else {
            // START
            btn.innerHTML = `<i class="fas fa-stop"></i> STOP FEED`;
            btn.style.background = "rgba(0,242,255,0.2)";
            indicator.style.display = "inline";
            
            liveInterval = setInterval(() => {
                // Pick random log
                const log = sampleLogs[Math.floor(Math.random() * sampleLogs.length)];
                
                // Type it into textarea
                const currentVal = inputArea.value;
                const newVal = log + "\n" + currentVal.substring(0, 500); // Keep buffer small
                inputArea.value = newVal;

                // Run scan on just this line
                signatures.forEach(sig => {
                    if(sig.regex.test(log)) createAlertCard(sig);
                });
                
                scannedCount++;
                document.getElementById('count-scanned').innerText = scannedCount;

            }, 1500);
        }
    }

    // --- 4. EXPORT REPORT ---
    function exportReport() {
        const data = {
            session_id: Date.now(),
            total_scanned: scannedCount,
            threats_detected: threatCount,
            engine_version: "2.4",
            timestamp: new Date().toISOString()
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], {type: "application/json"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `IDS_REPORT_${Date.now()}.json`;
        a.click();
    }

    function clearLogs() {
        inputArea.value = "";
        resultsFeed.innerHTML = `<div style="text-align:center; padding:20px; color:#444; border:1px dashed #333;">NO THREATS DETECTED</div>`;
    }
</script>

</body>
</html>